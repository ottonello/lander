<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunar Lander Game</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        canvas {
            border: 2px solid #333;
            background: linear-gradient(to bottom, #000428, #004e92);
            outline: none;
            cursor: crosshair;
        }
        
        canvas:focus {
            border-color: #666;
        }
        
        .controls {
            margin-top: 20px;
            text-align: center;
        }
        
        .info {
            margin-top: 10px;
            display: flex;
            gap: 30px;
            font-size: 18px;
        }
        
        .game-over, .difficulty-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        
        .difficulty-screen {
            display: block;
        }
        
        .difficulty-button {
            display: block;
            width: 200px;
            margin: 10px auto;
            padding: 15px;
            font-size: 16px;
        }
        
        .difficulty-easy { border-color: #4CAF50; }
        .difficulty-medium { border-color: #FF9800; }
        .difficulty-hard { border-color: #F44336; }
        .difficulty-nightmare { border-color: #9C27B0; }
        
        button {
            background: #333;
            color: #fff;
            border: 2px solid #666;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
            font-family: inherit;
        }
        
        button:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <h1>ðŸš€ Lunar Lander</h1>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    
    <div class="controls">
        <p><strong>Controls:</strong> Arrow Keys to thrust | Enter to pause | Space to restart</p>
        <p>Land gently on the flat surfaces to win!</p>
        <p><em>Click on the game area if controls stop working</em></p>
    </div>
    
    <div class="info">
        <div>Fuel: <span id="fuel">100</span>%</div>
        <div>Altitude: <span id="altitude">0</span>m</div>
        <div>Velocity: <span id="velocity">0.0</span> m/s</div>
    </div>
    
    <div class="difficulty-screen" id="difficultyScreen">
        <h2>ðŸš€ Select Difficulty</h2>
        <p>Choose your mission difficulty level</p>
        
        <button class="difficulty-button difficulty-easy" onclick="startGame('easy')">
            <strong>EASY</strong><br>
            Low gravity â€¢ Large landing pads â€¢ Smooth terrain â€¢ Efficient fuel
        </button>
        
        <button class="difficulty-button difficulty-medium" onclick="startGame('medium')">
            <strong>MEDIUM</strong><br>
            Normal gravity â€¢ Medium landing pads â€¢ Moderate terrain â€¢ Standard fuel
        </button>
        
        <button class="difficulty-button difficulty-hard" onclick="startGame('hard')">
            <strong>HARD</strong><br>
            High gravity â€¢ Small landing pads â€¢ Rough terrain â€¢ Higher fuel usage
        </button>
        
        <button class="difficulty-button difficulty-nightmare" onclick="startGame('nightmare')">
            <strong>NIGHTMARE</strong><br>
            Extreme gravity â€¢ Tiny landing pads â€¢ Chaotic terrain â€¢ Fuel hungry
        </button>
    </div>
    
    <div class="game-over" id="gameOver">
        <h2 id="gameOverTitle">Game Over</h2>
        <p id="gameOverMessage"></p>
        <button onclick="restartGame()">Play Again</button>
        <button onclick="showDifficultyScreen()">Change Difficulty</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game state
        let game = {
            lander: {
                x: 400,
                y: 50,
                vx: 0,
                vy: 0,
                angle: 0,
                fuel: 100,
                thrust: false,
                thrustLeft: false,
                thrustRight: false,
                size: 15
            },
            gravity: 0.1,
            thrustPower: 0.2,
            rotationSpeed: 0.05,
            gameOver: false,
            won: false,
            stars: [],
            gameStarted: false,
            difficulty: 'medium',
            paused: false
        };
        
        // Difficulty settings
        const difficulties = {
            easy: {
                gravity: 0.015,
                thrustPower: 0.15,
                fuelConsumptionMain: 0.05,
                fuelConsumptionRotation: 0.02,
                landingPadSize: 120,
                terrainRoughness: 10,
                landingPads: [
                    { start: 100, end: 220, height: canvas.height - 80 },
                    { start: 340, end: 460, height: canvas.height - 120 },
                    { start: 580, end: 700, height: canvas.height - 60 }
                ]
            },
            medium: {
                gravity: 0.03,
                thrustPower: 0.12,
                fuelConsumptionMain: 0.08,
                fuelConsumptionRotation: 0.03,
                landingPadSize: 80,
                terrainRoughness: 20,
                landingPads: [
                    { start: 160, end: 240, height: canvas.height - 80 },
                    { start: 420, end: 500, height: canvas.height - 120 },
                    { start: 660, end: 740, height: canvas.height - 60 }
                ]
            },
            hard: {
                gravity: 0.05,
                thrustPower: 0.1,
                fuelConsumptionMain: 0.12,
                fuelConsumptionRotation: 0.05,
                landingPadSize: 60,
                terrainRoughness: 35,
                landingPads: [
                    { start: 180, end: 240, height: canvas.height - 90 },
                    { start: 370, end: 430, height: canvas.height - 140 },
                    { start: 620, end: 680, height: canvas.height - 70 }
                ]
            },
            nightmare: {
                gravity: 0.07,
                thrustPower: 0.08,
                fuelConsumptionMain: 0.15,
                fuelConsumptionRotation: 0.08,
                landingPadSize: 40,
                terrainRoughness: 50,
                landingPads: [
                    { start: 200, end: 240, height: canvas.height - 100 },
                    { start: 380, end: 420, height: canvas.height - 160 },
                    { start: 600, end: 640, height: canvas.height - 80 }
                ]
            }
        };
        
        // Generate random stars for background
        function generateStars() {
            game.stars = [];
            for (let i = 0; i < 100; i++) {
                game.stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height * 0.7,
                    brightness: Math.random()
                });
            }
        }
        
        // Terrain generation
        const terrain = [];
        function generateTerrain() {
            terrain.length = 0;
            let height = canvas.height - 100;
            
            const diffSettings = difficulties[game.difficulty];
            const landingPads = diffSettings.landingPads;
            const roughness = diffSettings.terrainRoughness;
            
            for (let x = 0; x <= canvas.width; x += 10) {
                let isLandingPad = false;
                let padHeight = height;
                
                // Check if this x position is on a landing pad
                for (let pad of landingPads) {
                    if (x >= pad.start && x <= pad.end) {
                        isLandingPad = true;
                        padHeight = pad.height;
                        break;
                    }
                }
                
                if (isLandingPad) {
                    height = padHeight;
                } else {
                    // Add randomness based on difficulty
                    height += (Math.random() - 0.5) * roughness;
                    height = Math.max(canvas.height - 250, Math.min(canvas.height - 40, height));
                }
                
                terrain.push({ x: x, y: height, isLandingPad: isLandingPad });
            }
        }
        
        // Input handling
        const keys = {
            ArrowUp: false,
            ArrowLeft: false,
            ArrowRight: false,
            Space: false,
            Enter: false
        };
        
        document.addEventListener('keydown', (e) => {
            if (e.code in keys) {
                keys[e.code] = true;
                e.preventDefault();
            }
            
            if (e.code === 'Space' && game.gameOver) {
                restartGame();
                e.preventDefault();
            }
            
            if (e.code === 'Enter' && game.gameStarted && !game.gameOver) {
                game.paused = !game.paused;
                e.preventDefault();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (e.code in keys) {
                keys[e.code] = false;
                e.preventDefault();
            }
        });
        
        window.addEventListener('blur', () => {
            Object.keys(keys).forEach(key => keys[key] = false);
        });
        
        function handleInput() {
            if (game.gameOver || !game.gameStarted || game.paused) return;
            
            const diffSettings = difficulties[game.difficulty];
            
            game.lander.thrust = false;
            game.lander.thrustLeft = false;
            game.lander.thrustRight = false;
            
            if (keys.ArrowUp && game.lander.fuel > 0) {
                game.lander.thrust = true;
                game.lander.fuel -= diffSettings.fuelConsumptionMain;
                game.lander.fuel = Math.max(0, game.lander.fuel);
            }
            
            if (keys.ArrowLeft && game.lander.fuel > 0) {
                game.lander.thrustLeft = true;
                game.lander.fuel -= diffSettings.fuelConsumptionRotation;
                game.lander.fuel = Math.max(0, game.lander.fuel);
            }
            
            if (keys.ArrowRight && game.lander.fuel > 0) {
                game.lander.thrustRight = true;
                game.lander.fuel -= diffSettings.fuelConsumptionRotation;
                game.lander.fuel = Math.max(0, game.lander.fuel);
            }
        }
        
        function updatePhysics() {
            if (game.gameOver || !game.gameStarted || game.paused) return;
            
            const lander = game.lander;
            const diffSettings = difficulties[game.difficulty];
            
            if (lander.thrust) {
                const thrustX = Math.sin(lander.angle) * diffSettings.thrustPower;
                const thrustY = -Math.cos(lander.angle) * diffSettings.thrustPower;
                lander.vx += thrustX;
                lander.vy += thrustY;
            }
            
            if (lander.thrustLeft) {
                lander.angle -= game.rotationSpeed;
            }
            if (lander.thrustRight) {
                lander.angle += game.rotationSpeed;
            }
            
            lander.vy += diffSettings.gravity;
            
            lander.x += lander.vx;
            lander.y += lander.vy;
            
            lander.vx *= 0.999;
            lander.vy *= 0.999;
            
            if (lander.x < 0) {
                lander.x = 0;
                lander.vx = Math.abs(lander.vx) * 0.5;
            }
            if (lander.x > canvas.width) {
                lander.x = canvas.width;
                lander.vx = -Math.abs(lander.vx) * 0.5;
            }
            
            if (lander.y < 0) {
                lander.y = 0;
                lander.vy = Math.abs(lander.vy) * 0.5;
            }
            
            checkCollision();
        }
        
        function checkCollision() {
            const lander = game.lander;
            const landerBottom = lander.y + lander.size;
            
            let terrainHeight = canvas.height;
            let isOnLandingPad = false;
            
            for (let i = 0; i < terrain.length - 1; i++) {
                if (lander.x >= terrain[i].x && lander.x <= terrain[i + 1].x) {
                    terrainHeight = terrain[i].y;
                    isOnLandingPad = terrain[i].isLandingPad;
                    break;
                }
            }
            
            if (landerBottom >= terrainHeight) {
                const speed = Math.sqrt(lander.vx * lander.vx + lander.vy * lander.vy);
                const angle = Math.abs(lander.angle);
                
                if (isOnLandingPad && speed < 2 && angle < 0.3) {
                    game.won = true;
                    game.gameOver = true;
                    showGameOver("Mission Accomplished!", "Perfect landing! You're a true pilot.");
                } else {
                    game.gameOver = true;
                    let message = "Crashed! ";
                    if (!isOnLandingPad) message += "You must land on the flat surfaces.";
                    else if (speed >= 2) message += "Landing speed too high!";
                    else if (angle >= 0.3) message += "Landing angle too steep!";
                    
                    showGameOver("Mission Failed", message);
                }
                
                lander.vx = 0;
                lander.vy = 0;
                lander.y = terrainHeight - lander.size;
            }
        }
        
        function startGame(difficulty) {
            console.log('Starting game with difficulty:', difficulty);
            
            game.difficulty = difficulty;
            game.gameStarted = true;
            
            document.getElementById('difficultyScreen').style.display = 'none';
            
            resetLander();
            generateTerrain();
            
            game.lander.vx = 0.1; // Small test velocity
        }
        
        function showDifficultyScreen() {
            game.gameStarted = false;
            game.gameOver = false;
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('difficultyScreen').style.display = 'block';
        }
        
        function resetLander() {
            game.lander = {
                x: 400,
                y: 50,
                vx: 0,
                vy: 0,
                angle: 0,
                fuel: 100,
                thrust: false,
                thrustLeft: false,
                thrustRight: false,
                size: 15
            };
            game.gameOver = false;
            game.won = false;
            game.paused = false;
        }
        
        function restartGame() {
            resetLander();
            generateTerrain();
            document.getElementById('gameOver').style.display = 'none';
        }
        
        function showGameOver(title, message) {
            document.getElementById('gameOverTitle').textContent = title;
            document.getElementById('gameOverMessage').textContent = message;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        function drawStars() {
            ctx.fillStyle = '#fff';
            for (let star of game.stars) {
                ctx.globalAlpha = star.brightness;
                ctx.fillRect(star.x, star.y, 1, 1);
            }
            ctx.globalAlpha = 1;
        }
        
        function drawTerrain() {
            ctx.strokeStyle = '#666';
            ctx.fillStyle = '#333';
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.moveTo(0, canvas.height);
            
            for (let point of terrain) {
                ctx.lineTo(point.x, point.y);
            }
            
            ctx.lineTo(canvas.width, canvas.height);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            ctx.strokeStyle = '#0f0';
            ctx.lineWidth = 3;
            for (let i = 0; i < terrain.length - 1; i++) {
                if (terrain[i].isLandingPad) {
                    ctx.beginPath();
                    ctx.moveTo(terrain[i].x, terrain[i].y);
                    ctx.lineTo(terrain[i + 1].x, terrain[i + 1].y);
                    ctx.stroke();
                }
            }
        }
        
        function drawLander() {
            const lander = game.lander;
            
            ctx.save();
            ctx.translate(lander.x, lander.y);
            ctx.rotate(lander.angle);
            
            ctx.fillStyle = '#fff';
            ctx.fillRect(-8, -8, 16, 16);
            
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(-8, 8);
            ctx.lineTo(-12, 16);
            ctx.moveTo(8, 8);
            ctx.lineTo(12, 16);
            ctx.stroke();
            
            if (lander.thrust && lander.fuel > 0) {
                ctx.fillStyle = '#ff4444';
                ctx.beginPath();
                ctx.moveTo(-4, 8);
                ctx.lineTo(0, 20 + Math.random() * 10);
                ctx.lineTo(4, 8);
                ctx.closePath();
                ctx.fill();
            }
            
            if (lander.thrustLeft && lander.fuel > 0) {
                ctx.fillStyle = '#4444ff';
                ctx.fillRect(8, -2, 8, 4);
            }
            if (lander.thrustRight && lander.fuel > 0) {
                ctx.fillStyle = '#4444ff';
                ctx.fillRect(-16, -2, 8, 4);
            }
            
            ctx.restore();
        }
        
        function drawFuelGauge() {
            if (!game.gameStarted || game.gameOver) return;
            
            const gaugeX = canvas.width - 120;
            const gaugeY = 20;
            const gaugeWidth = 100;
            const gaugeHeight = 20;
            
            ctx.fillStyle = '#333';
            ctx.fillRect(gaugeX, gaugeY, gaugeWidth, gaugeHeight);
            
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            ctx.strokeRect(gaugeX, gaugeY, gaugeWidth, gaugeHeight);
            
            const fuelPercent = Math.max(0, game.lander.fuel / 100);
            const fuelWidth = (gaugeWidth - 4) * fuelPercent;
            
            if (fuelPercent > 0.5) {
                ctx.fillStyle = '#0f0';
            } else if (fuelPercent > 0.25) {
                ctx.fillStyle = '#ff0';
            } else {
                ctx.fillStyle = '#f00';
            }
            
            ctx.fillRect(gaugeX + 2, gaugeY + 2, fuelWidth, gaugeHeight - 4);
            
            ctx.fillStyle = '#fff';
            ctx.font = '12px Courier New';
            ctx.textAlign = 'right';
            ctx.fillText('FUEL', gaugeX - 5, gaugeY + 15);
            
            ctx.textAlign = 'center';
            ctx.fillText(Math.round(game.lander.fuel) + '%', gaugeX + gaugeWidth/2, gaugeY + 15);
            ctx.textAlign = 'left';
        }
        
        function drawPauseOverlay() {
            if (!game.paused) return;
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#fff';
            ctx.font = '48px Courier New';
            ctx.textAlign = 'center';
            ctx.fillText('PAUSED', canvas.width / 2, canvas.height / 2 - 40);
            
            ctx.font = '18px Courier New';
            ctx.fillText('Press ENTER to resume', canvas.width / 2, canvas.height / 2 + 20);
            
            ctx.font = '14px Courier New';
            ctx.fillStyle = '#ccc';
            ctx.fillText(`Fuel: ${Math.round(game.lander.fuel)}%`, canvas.width / 2, canvas.height / 2 + 60);
            ctx.fillText(`Altitude: ${Math.max(0, Math.round((canvas.height - game.lander.y) / 5))}m`, canvas.width / 2, canvas.height / 2 + 80);
            const velocity = Math.sqrt(game.lander.vx * game.lander.vx + game.lander.vy * game.lander.vy);
            ctx.fillText(`Velocity: ${velocity.toFixed(1)} m/s`, canvas.width / 2, canvas.height / 2 + 100);
            
            ctx.textAlign = 'left';
        }
        
        function updateUI() {
            const lander = game.lander;
            const altitude = Math.max(0, Math.round((canvas.height - lander.y) / 5));
            const velocity = Math.sqrt(lander.vx * lander.vx + lander.vy * lander.vy);
            
            document.getElementById('fuel').textContent = Math.max(0, Math.round(lander.fuel));
            document.getElementById('altitude').textContent = altitude;
            document.getElementById('velocity').textContent = velocity.toFixed(1);
        }
        
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (game.gameStarted) {
                handleInput();
                updatePhysics();
                
                drawStars();
                drawTerrain();
                drawLander();
                drawFuelGauge();
                drawPauseOverlay();
                
                updateUI();
            } else {
                drawStars();
                
                ctx.fillStyle = '#fff';
                ctx.font = '24px Courier New';
                ctx.textAlign = 'center';
                ctx.fillText('Select difficulty to begin mission', canvas.width / 2, canvas.height / 2);
                ctx.textAlign = 'left';
            }
            
            requestAnimationFrame(gameLoop);
        }
        
        // Initialize game
        generateStars();
        gameLoop();
    </script>
</body>
</html>
